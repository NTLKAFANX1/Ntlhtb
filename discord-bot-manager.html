<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ù†ØµØ© Ø¥Ø¯Ø§Ø±Ø© Ø¨ÙˆØªØ§Øª Ø¯ÙŠØ³ÙƒÙˆØ±Ø¯</title>
    <style>
        /* Reset and Base */
        *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: 'Segoe UI', Tahoma, Arial, sans-serif; line-height: 1.6; color: #333; }
        
        /* Layout */
        .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
        .grid { display: grid; gap: 20px; }
        .grid-3 { grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); }
        .grid-4 { grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); }
        .flex { display: flex; align-items: center; gap: 10px; }
        .flex-between { display: flex; justify-content: space-between; align-items: center; }
        .hidden { display: none !important; }
        
        /* Background */
        body { background: linear-gradient(135deg, #f3e8ff 0%, #dbeafe 50%, #cffafe 100%); min-height: 100vh; }
        
        /* Cards */
        .card { 
            background: white; 
            border-radius: 12px; 
            padding: 24px; 
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            border: 2px solid #e5e7eb;
            transition: all 0.3s ease;
        }
        .card:hover { transform: translateY(-2px); box-shadow: 0 8px 20px rgba(0,0,0,0.15); }
        
        /* Buttons */
        .btn {
            padding: 10px 20px;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
            font-size: 14px;
        }
        
        .btn-primary { background: #3b82f6; color: white; }
        .btn-primary:hover { background: #2563eb; }
        .btn-success { background: #10b981; color: white; }
        .btn-success:hover { background: #059669; }
        .btn-danger { background: #ef4444; color: white; }
        .btn-danger:hover { background: #dc2626; }
        .btn-secondary { background: #f3f4f6; color: #374151; border: 1px solid #d1d5db; }
        .btn-secondary:hover { background: #e5e7eb; }
        .btn-sm { padding: 6px 12px; font-size: 12px; }
        
        /* Forms */
        .input, .textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.2s;
        }
        .input:focus, .textarea:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }
        .textarea { min-height: 80px; resize: vertical; font-family: inherit; }
        
        /* Code Editor */
        .code-editor {
            width: 100%;
            height: 400px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            padding: 16px;
            background: #f9fafb;
            resize: none;
            line-height: 1.5;
        }
        .code-editor:focus {
            outline: none;
            border-color: #3b82f6;
            background: white;
        }
        
        /* File Tabs */
        .file-tabs { display: flex; flex-wrap: wrap; gap: 4px; margin-bottom: 16px; }
        .file-tab {
            padding: 8px 16px;
            background: #f3f4f6;
            border: 1px solid #d1d5db;
            border-bottom: none;
            border-radius: 6px 6px 0 0;
            cursor: pointer;
            font-size: 13px;
            transition: all 0.2s;
        }
        .file-tab:hover { background: #e5e7eb; }
        .file-tab.active { background: white; color: #3b82f6; font-weight: 600; }
        
        /* Status */
        .status {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }
        .status-active { background: #10b981; color: white; }
        .status-inactive { background: #ef4444; color: white; }
        
        /* Chat */
        .chat-container {
            height: 300px;
            overflow-y: auto;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            padding: 16px;
            background: #f9fafb;
            margin-bottom: 12px;
        }
        .chat-message {
            margin-bottom: 12px;
            padding: 12px;
            border-radius: 8px;
            max-width: 80%;
        }
        .chat-user { background: #dbeafe; margin-left: auto; }
        .chat-ai { background: #f3f4f6; margin-right: auto; }
        
        /* Typography */
        h1 { font-size: 2.5rem; font-weight: 800; margin-bottom: 8px; }
        h2 { font-size: 1.8rem; font-weight: 700; margin-bottom: 16px; }
        h3 { font-size: 1.4rem; font-weight: 600; margin-bottom: 12px; }
        h4 { font-size: 1.2rem; font-weight: 600; }
        .text-center { text-align: center; }
        .text-gray { color: #6b7280; }
        .mb-4 { margin-bottom: 16px; }
        .mb-6 { margin-bottom: 24px; }
        
        /* Icons */
        .icon { width: 16px; height: 16px; display: inline-block; margin-left: 6px; }
        
        /* Responsive */
        @media (max-width: 768px) {
            .container { padding: 16px; }
            .grid-3, .grid-4 { grid-template-columns: 1fr; }
            h1 { font-size: 2rem; }
        }
        
        /* Animations */
        .fade-in { animation: fadeIn 0.3s ease-in; }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Loading */
        .loading { 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            min-height: 200px; 
            color: #6b7280; 
        }
    </style>
</head>
<body>
    <div id="app" class="container">
        <div id="loading" class="loading">
            <div>Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ù…Ù†ØµØ© Ø¨ÙˆØªØ§Øª Ø¯ÙŠØ³ÙƒÙˆØ±Ø¯... ğŸ¤–</div>
        </div>
    </div>

    <!-- Toast Container -->
    <div id="toastContainer" style="position: fixed; top: 20px; right: 20px; z-index: 1000;"></div>

    <script>
        // App State Management
        class AppState {
            constructor() {
                this.bots = JSON.parse(localStorage.getItem('discord-bots') || '[]');
                this.currentBot = null;
                this.showAI = false;
                this.selectedFile = 'index.js';
                this.showCode = false;
                this.aiChats = JSON.parse(localStorage.getItem('ai-chats') || '[]');
                this.currentBotId = null;
            }

            saveBots() {
                localStorage.setItem('discord-bots', JSON.stringify(this.bots));
            }

            addBot(bot) {
                bot.id = 'bot_' + Math.random().toString(36).substr(2, 9);
                bot.createdAt = new Date().toISOString();
                bot.isActive = false;
                bot.files = bot.files || { 'index.js': this.getDefaultCode() };
                this.bots.push(bot);
                this.saveBots();
                return bot;
            }

            updateBot(id, updates) {
                const index = this.bots.findIndex(b => b.id === id);
                if (index !== -1) {
                    this.bots[index] = { ...this.bots[index], ...updates };
                    this.saveBots();
                    return this.bots[index];
                }
                return null;
            }

            deleteBot(id) {
                const index = this.bots.findIndex(b => b.id === id);
                if (index !== -1) {
                    this.bots.splice(index, 1);
                    this.saveBots();
                    return true;
                }
                return false;
            }

            getBot(id) {
                return this.bots.find(b => b.id === id);
            }

            getDefaultCode() {
                return \`// Ø¨ÙˆØª Ø¯ÙŠØ³ÙƒÙˆØ±Ø¯ Ø£Ø³Ø§Ø³ÙŠ
const { Client, GatewayIntentBits, Events } = require('discord.js');

const client = new Client({
    intents: [
        GatewayIntentBits.Guilds,
        GatewayIntentBits.GuildMessages,
        GatewayIntentBits.MessageContent,
    ],
});

client.once(Events.ClientReady, (readyClient) => {
    console.log(\\\`ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙƒÙ€ \\\${readyClient.user.tag}!\\\`);
});

client.on(Events.MessageCreate, (message) => {
    if (message.author.bot) return;
    
    if (message.content === '!ping') {
        message.reply('Pong!');
    }
    
    if (message.content === '!hello') {
        message.reply('Ù…Ø±Ø­Ø¨Ø§Ù‹! ğŸ‘‹');
    }
});

// ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ù„Ø¨ÙˆØª
client.login('YOUR_BOT_TOKEN_HERE');\`;
            }
        }

        // Simple Router
        class Router {
            constructor() {
                this.currentPage = 'dashboard';
                this.params = {};
            }

            navigate(page, params = {}) {
                this.currentPage = page;
                this.params = params;
                this.render();
            }

            render() {
                const app = document.getElementById('app');
                
                switch(this.currentPage) {
                    case 'dashboard':
                        this.renderDashboard(app);
                        break;
                    case 'editor':
                        this.renderEditor(app, this.params);
                        break;
                    default:
                        this.renderDashboard(app);
                }
            }

            renderDashboard(container) {
                const activeBots = appState.bots.filter(bot => bot.isActive);
                
                container.innerHTML = \`
                    <div class="fade-in">
                        <!-- Header -->
                        <div class="text-center mb-6">
                            <h1>ğŸ¤– Ù…Ù†ØµØ© Ø¥Ø¯Ø§Ø±Ø© Ø¨ÙˆØªØ§Øª Ø¯ÙŠØ³ÙƒÙˆØ±Ø¯</h1>
                            <p class="text-gray">Ø£Ù†Ø´Ø¦ ÙˆØ£Ø¯Ø± Ø¨ÙˆØªØ§ØªÙƒ Ø¨Ø³Ù‡ÙˆÙ„Ø©</p>
                        </div>

                        <!-- Stats -->
                        <div class="grid grid-3 mb-6">
                            <div class="card text-center">
                                <div style="font-size: 2.5rem; font-weight: bold; color: #3b82f6; margin-bottom: 8px;">\${appState.bots.length}</div>
                                <div class="text-gray">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¨ÙˆØªØ§Øª</div>
                            </div>
                            <div class="card text-center">
                                <div style="font-size: 2.5rem; font-weight: bold; color: #10b981; margin-bottom: 8px;">\${activeBots.length}</div>
                                <div class="text-gray">Ø§Ù„Ø¨ÙˆØªØ§Øª Ø§Ù„Ù†Ø´Ø·Ø©</div>
                            </div>
                            <div class="card text-center">
                                <div style="font-size: 2.5rem; font-weight: bold; color: #8b5cf6; margin-bottom: 8px;">\${appState.bots.length - activeBots.length}</div>
                                <div class="text-gray">Ø§Ù„Ø¨ÙˆØªØ§Øª Ø§Ù„Ù…ØªÙˆÙ‚ÙØ©</div>
                            </div>
                        </div>

                        <!-- Quick Actions -->
                        <div class="grid grid-3 mb-6">
                            <div class="card text-center" style="cursor: pointer;" onclick="router.navigate('editor', {isNew: true})">
                                <div style="font-size: 3rem; margin-bottom: 16px;">â•</div>
                                <h3>Ø¥Ù†Ø´Ø§Ø¡ Ø¨ÙˆØª Ø¬Ø¯ÙŠØ¯</h3>
                                <p class="text-gray">Ø§Ø¨Ø¯Ø£ ÙÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø¨ÙˆØª Ø¯ÙŠØ³ÙƒÙˆØ±Ø¯ Ø¬Ø¯ÙŠØ¯ Ù…Ù† Ø§Ù„ØµÙØ±</p>
                            </div>
                            
                            <div class="card text-center" style="cursor: pointer;" onclick="document.getElementById('fileInput').click()">
                                <div style="font-size: 3rem; margin-bottom: 16px;">ğŸ“</div>
                                <h3>Ø±ÙØ¹ Ù…Ù„Ù Ø¨ÙˆØª</h3>
                                <p class="text-gray">Ø§Ø±ÙØ¹ Ù…Ù„Ù JavaScript Ù„Ø¨ÙˆØª Ù…ÙˆØ¬ÙˆØ¯</p>
                                <input type="file" id="fileInput" accept=".js,.txt" style="display: none;" onchange="handleFileUpload(event)">
                            </div>
                            
                            <div class="card text-center" style="cursor: pointer;" onclick="toggleAIChat()">
                                <div style="font-size: 3rem; margin-bottom: 16px;">ğŸ§ </div>
                                <h3>Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø°ÙƒÙŠ</h3>
                                <p class="text-gray">Ø§Ø­ØµÙ„ Ø¹Ù„Ù‰ Ù…Ø³Ø§Ø¹Ø¯Ø© ÙÙŠ Ø§Ù„Ø¨Ø±Ù…Ø¬Ø©</p>
                            </div>
                        </div>

                        <!-- AI Chat -->
                        <div id="aiChatSection" class="hidden card mb-6">
                            <h3>ğŸ’¬ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø°ÙƒÙŠ</h3>
                            <div id="aiChatMessages" class="chat-container">
                                <div class="chat-message chat-ai">
                                    <strong>Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø°ÙƒÙŠ:</strong> Ù…Ø±Ø­Ø¨Ø§Ù‹! ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ ÙÙŠ Ø¨Ø±Ù…Ø¬Ø© Ø¨ÙˆØªØ§Øª Ø¯ÙŠØ³ÙƒÙˆØ±Ø¯. Ø§Ø³Ø£Ù„ Ø£ÙŠ Ø³Ø¤Ø§Ù„!
                                </div>
                            </div>
                            <div class="flex">
                                <input type="text" id="aiInput" class="input" placeholder="Ø§Ø³Ø£Ù„ Ø³Ø¤Ø§Ù„Ùƒ Ù‡Ù†Ø§..." onkeypress="if(event.key==='Enter') sendAIMessage()" style="margin-left: 8px;">
                                <button class="btn btn-primary" onclick="sendAIMessage()">Ø¥Ø±Ø³Ø§Ù„</button>
                                <button class="btn btn-secondary" onclick="toggleAIChat()">Ø¥ØºÙ„Ø§Ù‚</button>
                            </div>
                        </div>

                        <!-- Bots List -->
                        <div>
                            <h2>Ø§Ù„Ø¨ÙˆØªØ§Øª Ø§Ù„Ù…ØªÙˆÙØ±Ø© (\${appState.bots.length})</h2>
                            <div class="grid grid-4" id="botsList">
                                \${appState.bots.length === 0 ? 
                                    '<div style="grid-column: 1/-1; text-align: center; padding: 48px; color: #6b7280;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙˆØªØ§Øª Ø­ØªÙ‰ Ø§Ù„Ø¢Ù†. Ø§Ø¨Ø¯Ø£ Ø¨Ø¥Ù†Ø´Ø§Ø¡ Ø¨ÙˆØª Ø¬Ø¯ÙŠØ¯! ğŸš€</div>' :
                                    appState.bots.map(bot => \`
                                        <div class="card">
                                            <div class="flex-between mb-4">
                                                <div>
                                                    <h4>\${bot.name}</h4>
                                                    <p class="text-gray" style="font-size: 13px;">\${bot.description || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ ÙˆØµÙ'}</p>
                                                </div>
                                                <span class="status \${bot.isActive ? 'status-active' : 'status-inactive'}">
                                                    \${bot.isActive ? 'Ù†Ø´Ø·' : 'Ù…ØªÙˆÙ‚Ù'}
                                                </span>
                                            </div>
                                            
                                            <div class="text-gray mb-4" style="font-size: 12px;">
                                                Ø§Ù„Ù…Ù„ÙØ§Øª: \${Object.keys(bot.files || {}).join(', ')}
                                            </div>
                                            
                                            <div style="display: flex; gap: 8px;">
                                                <button class="btn btn-primary btn-sm" onclick="router.navigate('editor', {id: '\${bot.id}'})">
                                                    âœï¸ ØªØ¹Ø¯ÙŠÙ„
                                                </button>
                                                <button class="btn \${bot.isActive ? 'btn-danger' : 'btn-success'} btn-sm" onclick="toggleBot('\${bot.id}')">
                                                    \${bot.isActive ? 'â¹ï¸ Ø¥ÙŠÙ‚Ø§Ù' : 'â–¶ï¸ ØªØ´ØºÙŠÙ„'}
                                                </button>
                                                <button class="btn btn-secondary btn-sm" onclick="deleteBot('\${bot.id}')">ğŸ—‘ï¸</button>
                                            </div>
                                        </div>
                                    \`).join('')
                                }
                            </div>
                        </div>
                    </div>
                \`;
            }

            renderEditor(container, params) {
                const isNew = params.isNew;
                const bot = isNew ? null : appState.getBot(params.id);
                
                if (!isNew && !bot) {
                    showNotification('Ø§Ù„Ø¨ÙˆØª ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯!', 'error');
                    this.navigate('dashboard');
                    return;
                }

                const formData = isNew ? {
                    name: '',
                    description: '',
                    token: '',
                    files: { 'index.js': appState.getDefaultCode() }
                } : {
                    name: bot.name,
                    description: bot.description || '',
                    token: bot.token,
                    files: bot.files || { 'index.js': appState.getDefaultCode() }
                };

                if (!appState.selectedFile || !formData.files[appState.selectedFile]) {
                    appState.selectedFile = Object.keys(formData.files)[0];
                }

                container.innerHTML = \`
                    <div class="fade-in">
                        <!-- Header -->
                        <div class="flex-between mb-6">
                            <div class="flex">
                                <button class="btn btn-secondary" onclick="router.navigate('dashboard')">
                                    â† Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…
                                </button>
                                <h1>\${isNew ? 'Ø¨ÙˆØª Ø¬Ø¯ÙŠØ¯' : 'ØªØ­Ø±ÙŠØ± Ø§Ù„Ø¨ÙˆØª'}</h1>
                            </div>
                            
                            <button class="btn \${appState.showAI ? 'btn-primary' : 'btn-secondary'}" onclick="toggleEditorAI()">
                                ğŸ§  Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø°ÙƒÙŠ
                            </button>
                        </div>

                        <div class="grid" style="grid-template-columns: \${appState.showAI ? '300px 1fr 300px' : '300px 1fr'};">
                            <!-- Bot Settings -->
                            <div class="card">
                                <h2>Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¨ÙˆØª</h2>
                                
                                <div class="mb-4">
                                    <label style="display: block; margin-bottom: 8px; font-weight: 600;">Ø§Ø³Ù… Ø§Ù„Ø¨ÙˆØª</label>
                                    <input type="text" id="botName" class="input" value="\${formData.name}" placeholder="Ø§Ø³Ù… Ø§Ù„Ø¨ÙˆØª">
                                </div>

                                <div class="mb-4">
                                    <label style="display: block; margin-bottom: 8px; font-weight: 600;">Ø§Ù„ÙˆØµÙ</label>
                                    <textarea id="botDescription" class="input textarea" placeholder="ÙˆØµÙ Ø§Ù„Ø¨ÙˆØª">\${formData.description}</textarea>
                                </div>

                                <div class="mb-4">
                                    <label style="display: block; margin-bottom: 8px; font-weight: 600;">ØªÙˆÙƒÙ† Ø§Ù„Ø¨ÙˆØª</label>
                                    <input type="password" id="botToken" class="input" value="\${formData.token}" placeholder="ØªÙˆÙƒÙ† Ø¯ÙŠØ³ÙƒÙˆØ±Ø¯">
                                </div>

                                <button class="btn btn-primary" style="width: 100%;" onclick="saveBot(\${isNew}, '\${params.id || ''}')">
                                    ğŸ’¾ Ø­ÙØ¸
                                </button>

                                \${!isNew && bot ? \`
                                    <div style="margin-top: 20px; padding-top: 20px; border-top: 1px solid #e5e7eb;">
                                        <div class="flex-between mb-4">
                                            <span style="font-weight: 600;">Ø­Ø§Ù„Ø© Ø§Ù„Ø¨ÙˆØª</span>
                                            <span class="status \${bot.isActive ? 'status-active' : 'status-inactive'}">
                                                \${bot.isActive ? 'Ù†Ø´Ø·' : 'Ù…ØªÙˆÙ‚Ù'}
                                            </span>
                                        </div>
                                        
                                        <div style="display: flex; gap: 8px;">
                                            <button class="btn \${bot.isActive ? 'btn-danger' : 'btn-success'}" style="flex: 1;" onclick="toggleBot('\${bot.id}')">
                                                \${bot.isActive ? 'â¹ï¸ Ø¥ÙŠÙ‚Ø§Ù' : 'â–¶ï¸ ØªØ´ØºÙŠÙ„'}
                                            </button>
                                            <button class="btn btn-secondary" onclick="restartBot('\${bot.id}')">ğŸ”„</button>
                                        </div>
                                    </div>
                                \` : ''}
                            </div>

                            <!-- File Manager & Code Editor -->
                            <div>
                                <!-- File Manager -->
                                <div class="card mb-4">
                                    <div class="flex-between mb-4">
                                        <h2>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ù„ÙØ§Øª</h2>
                                        <button class="btn btn-secondary" onclick="toggleCodeVisibility()">
                                            ğŸ“„ \${appState.showCode ? 'Ø¥Ø®ÙØ§Ø¡ Ø§Ù„ÙƒÙˆØ¯' : 'Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„ÙƒÙˆØ¯'}
                                        </button>
                                    </div>
                                    
                                    <!-- File Tabs -->
                                    <div class="file-tabs">
                                        \${Object.keys(formData.files).map(fileName => \`
                                            <div style="display: flex;">
                                                <button class="file-tab \${appState.selectedFile === fileName ? 'active' : ''}" onclick="selectFile('\${fileName}')">
                                                    \${fileName}
                                                </button>
                                                \${Object.keys(formData.files).length > 1 ? \`
                                                    <button class="btn btn-danger btn-sm" style="border-radius: 0 6px 0 0; padding: 4px 8px;" onclick="deleteFile('\${fileName}')">ğŸ—‘ï¸</button>
                                                \` : ''}
                                            </div>
                                        \`).join('')}
                                    </div>

                                    <!-- Add New File -->
                                    <div class="flex">
                                        <input type="text" id="newFileName" class="input" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø¬Ø¯ÙŠØ¯ (Ù…Ø«Ù„: commands.js)" style="margin-left: 8px;" onkeypress="if(event.key==='Enter') addNewFile()">
                                        <button class="btn btn-primary" onclick="addNewFile()">â• Ø¥Ø¶Ø§ÙØ©</button>
                                    </div>
                                </div>

                                <!-- Code Editor -->
                                <div id="codeEditorSection" class="\${appState.showCode ? 'card' : 'hidden'}">
                                    <h2>Ù…Ø­Ø±Ø± Ø§Ù„ÙƒÙˆØ¯ - \${appState.selectedFile}</h2>
                                    <textarea id="codeEditor" class="code-editor" placeholder="Ø§ÙƒØªØ¨ ÙƒÙˆØ¯ Ø§Ù„Ø¨ÙˆØª Ù‡Ù†Ø§...">\${formData.files[appState.selectedFile] || ''}</textarea>
                                </div>
                            </div>

                            <!-- AI Assistant -->
                            \${appState.showAI ? \`
                                <div class="card">
                                    <h3>ğŸ¤– Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø°ÙƒÙŠ</h3>
                                    <div id="editorAiChatMessages" class="chat-container">
                                        <div class="chat-message chat-ai">
                                            <strong>Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯:</strong> ÙƒÙŠÙ ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ ÙÙŠ ØªØ·ÙˆÙŠØ± Ø§Ù„Ø¨ÙˆØªØŸ
                                        </div>
                                    </div>
                                    <div class="flex mb-4">
                                        <input type="text" id="editorAiInput" class="input" placeholder="Ø§Ø³Ø£Ù„ Ø¹Ù† Ø§Ù„Ø¨Ø±Ù…Ø¬Ø©..." style="margin-left: 8px;" onkeypress="if(event.key==='Enter') sendEditorAIMessage()">
                                        <button class="btn btn-primary" onclick="sendEditorAIMessage()">Ø¥Ø±Ø³Ø§Ù„</button>
                                    </div>
                                    <button class="btn btn-secondary" style="width: 100%;" onclick="generateBotCode()">âœ¨ Ø¥Ù†Ø´Ø§Ø¡ ÙƒÙˆØ¯ ØªÙ„Ù‚Ø§Ø¦ÙŠ</button>
                                </div>
                            \` : ''}
                        </div>
                    </div>
                \`;

                // Store form data globally and setup event listeners
                window.currentFormData = formData;
                this.setupEventListeners();
            }

            setupEventListeners() {
                // Update form data when inputs change
                const nameInput = document.getElementById('botName');
                const descInput = document.getElementById('botDescription');
                const tokenInput = document.getElementById('botToken');
                const codeEditor = document.getElementById('codeEditor');

                if (nameInput) nameInput.addEventListener('input', (e) => {
                    window.currentFormData.name = e.target.value;
                });
                
                if (descInput) descInput.addEventListener('input', (e) => {
                    window.currentFormData.description = e.target.value;
                });
                
                if (tokenInput) tokenInput.addEventListener('input', (e) => {
                    window.currentFormData.token = e.target.value;
                });
                
                if (codeEditor) codeEditor.addEventListener('input', (e) => {
                    if (appState.selectedFile && window.currentFormData) {
                        window.currentFormData.files[appState.selectedFile] = e.target.value;
                    }
                });
            }
        }

        // Global Functions
        function showNotification(message, type = 'info') {
            const container = document.getElementById('toastContainer');
            const notification = document.createElement('div');
            
            const colors = {
                'error': '#ef4444',
                'success': '#10b981',
                'info': '#3b82f6'
            };
            
            notification.style.cssText = \`
                background: \${colors[type] || colors.info};
                color: white;
                padding: 12px 20px;
                border-radius: 8px;
                margin-bottom: 8px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.2);
                animation: slideIn 0.3s ease;
                font-weight: 600;
            \`;
            notification.textContent = message;
            
            container.appendChild(notification);
            
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.style.animation = 'slideOut 0.3s ease';
                    setTimeout(() => {
                        if (notification.parentNode) {
                            notification.parentNode.removeChild(notification);
                        }
                    }, 300);
                }
            }, 3000);
        }

        function toggleBot(id) {
            const bot = appState.getBot(id);
            if (!bot) return;

            if (!bot.token || bot.token === 'YOUR_BOT_TOKEN_HERE') {
                showNotification('ÙŠØ¬Ø¨ Ø¥Ø¶Ø§ÙØ© ØªÙˆÙƒÙ† ØµØ­ÙŠØ­ Ù„Ù„Ø¨ÙˆØª Ø£ÙˆÙ„Ø§Ù‹!', 'error');
                return;
            }

            const newStatus = !bot.isActive;
            appState.updateBot(id, { isActive: newStatus });
            
            showNotification(
                newStatus ? 'ØªÙ… ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¨ÙˆØª Ø¨Ù†Ø¬Ø§Ø­! ğŸš€' : 'ØªÙ… Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø¨ÙˆØª Ø¨Ù†Ø¬Ø§Ø­! â¹ï¸',
                'success'
            );
            
            router.render();
        }

        function restartBot(id) {
            const bot = appState.getBot(id);
            if (!bot) return;
            
            showNotification('Ø¬Ø§Ø±ÙŠ Ø¥Ø¹Ø§Ø¯Ø© ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¨ÙˆØª...', 'info');
            appState.updateBot(id, { isActive: false });
            
            setTimeout(() => {
                appState.updateBot(id, { isActive: true });
                showNotification('ØªÙ… Ø¥Ø¹Ø§Ø¯Ø© ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¨ÙˆØª Ø¨Ù†Ø¬Ø§Ø­! ğŸ”„', 'success');
                router.render();
            }, 1000);
        }

        function deleteBot(id) {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø¨ÙˆØªØŸ ğŸ—‘ï¸')) {
                appState.deleteBot(id);
                showNotification('ØªÙ… Ø­Ø°Ù Ø§Ù„Ø¨ÙˆØª Ø¨Ù†Ø¬Ø§Ø­!', 'success');
                
                if (router.currentPage === 'editor' && router.params.id === id) {
                    router.navigate('dashboard');
                } else {
                    router.render();
                }
            }
        }

        function saveBot(isNew, id) {
            const formData = window.currentFormData;
            
            if (!formData || !formData.name.trim()) {
                showNotification('Ø§Ø³Ù… Ø§Ù„Ø¨ÙˆØª Ù…Ø·Ù„ÙˆØ¨!', 'error');
                return;
            }

            if (!formData.token.trim()) {
                showNotification('ØªÙˆÙƒÙ† Ø§Ù„Ø¨ÙˆØª Ù…Ø·Ù„ÙˆØ¨!', 'error');
                return;
            }

            if (isNew) {
                const newBot = appState.addBot(formData);
                showNotification('ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¨ÙˆØª Ø¨Ù†Ø¬Ø§Ø­! ğŸ‰', 'success');
                router.navigate('editor', { id: newBot.id });
            } else {
                appState.updateBot(id, formData);
                showNotification('ØªÙ… Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª Ø¨Ù†Ø¬Ø§Ø­! ğŸ’¾', 'success');
            }
        }

        // File Management
        function selectFile(fileName) {
            appState.selectedFile = fileName;
            appState.showCode = true;
            router.render();
        }

        function addNewFile() {
            const input = document.getElementById('newFileName');
            const fileName = input.value.trim();
            
            if (!fileName) {
                showNotification('Ø§Ø³Ù… Ø§Ù„Ù…Ù„Ù Ù…Ø·Ù„ÙˆØ¨!', 'error');
                return;
            }
            
            const finalName = fileName.endsWith('.js') ? fileName : fileName + '.js';
            
            if (window.currentFormData) {
                if (window.currentFormData.files[finalName]) {
                    showNotification('Ø§Ù„Ù…Ù„Ù Ù…ÙˆØ¬ÙˆØ¯ Ø¨Ø§Ù„ÙØ¹Ù„!', 'error');
                    return;
                }
                
                window.currentFormData.files[finalName] = '// Ù…Ù„Ù Ø¬Ø¯ÙŠØ¯\\nconsole.log("Ù…Ø±Ø­Ø¨Ø§Ù‹ Ù…Ù† ' + finalName + '");';
                input.value = '';
                selectFile(finalName);
                showNotification('ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù„Ù Ø¨Ù†Ø¬Ø§Ø­! ğŸ“', 'success');
            }
        }

        function deleteFile(fileName) {
            if (!window.currentFormData) return;
            
            if (Object.keys(window.currentFormData.files).length <= 1) {
                showNotification('Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø­Ø°Ù Ø§Ù„Ù…Ù„Ù Ø§Ù„ÙˆØ­ÙŠØ¯!', 'error');
                return;
            }

            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ø§Ù„Ù…Ù„Ù ' + fileName + 'ØŸ')) {
                delete window.currentFormData.files[fileName];
                
                if (appState.selectedFile === fileName) {
                    appState.selectedFile = Object.keys(window.currentFormData.files)[0];
                }
                
                showNotification('ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ù„Ù Ø¨Ù†Ø¬Ø§Ø­!', 'success');
                router.render();
            }
        }

        function toggleCodeVisibility() {
            appState.showCode = !appState.showCode;
            router.render();
        }

        function toggleEditorAI() {
            appState.showAI = !appState.showAI;
            router.render();
        }

        // File Upload
        function handleFileUpload(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = (e) => {
                const content = e.target.result;
                router.navigate('editor', { isNew: true });
                
                setTimeout(() => {
                    if (window.currentFormData) {
                        window.currentFormData.files['index.js'] = content;
                        const editor = document.getElementById('codeEditor');
                        if (editor) {
                            editor.value = content;
                        }
                        showNotification('ØªÙ… Ø±ÙØ¹ Ø§Ù„Ù…Ù„Ù Ø¨Ù†Ø¬Ø§Ø­! ğŸ“', 'success');
                    }
                }, 100);
            };
            reader.readAsText(file);
            
            // Reset input
            event.target.value = '';
        }

        // AI Functions
        function toggleAIChat() {
            const aiChat = document.getElementById('aiChatSection');
            if (aiChat) {
                aiChat.className = aiChat.className.includes('hidden') ? 
                    'card mb-6 fade-in' : 
                    'hidden card mb-6';
            }
        }

        function sendAIMessage() {
            const input = document.getElementById('aiInput');
            const message = input.value.trim();
            
            if (!message) return;
            
            addMessageToAIChat('user', message, 'aiChatMessages');
            input.value = '';
            
            // Simulate AI response
            setTimeout(() => {
                let response = getAIResponse(message);
                addMessageToAIChat('assistant', response, 'aiChatMessages');
            }, 800);
        }

        function sendEditorAIMessage() {
            const input = document.getElementById('editorAiInput');
            const message = input.value.trim();
            
            if (!message) return;
            
            addMessageToAIChat('user', message, 'editorAiChatMessages');
            input.value = '';
            
            setTimeout(() => {
                const currentCode = document.getElementById('codeEditor')?.value || '';
                let response = getAIResponse(message, currentCode);
                addMessageToAIChat('assistant', response, 'editorAiChatMessages');
            }, 800);
        }

        function addMessageToAIChat(role, content, containerId) {
            const chat = document.getElementById(containerId);
            if (!chat) return;
            
            const messageDiv = document.createElement('div');
            messageDiv.className = \`chat-message \${role === 'user' ? 'chat-user' : 'chat-ai'}\`;
            messageDiv.innerHTML = \`
                <strong>\${role === 'user' ? 'Ø£Ù†Øª' : 'Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯'}:</strong> \${content}
            \`;
            
            chat.appendChild(messageDiv);
            chat.scrollTop = chat.scrollHeight;
        }

        function getAIResponse(message, currentCode = '') {
            const lowerMessage = message.toLowerCase();
            
            // Arabic keyword responses
            if (message.includes('Ø®Ø·Ø£') || message.includes('Ù…Ø´ÙƒÙ„Ø©') || message.includes('error')) {
                return 'ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ù‚ÙˆØ§Ø³ ÙˆØ§Ù„ÙÙˆØ§ØµÙ„ ÙÙŠ Ù…ÙƒØ§Ù†Ù‡Ø§ Ø§Ù„ØµØ­ÙŠØ­. ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù€ syntax ÙˆØªØ£ÙƒØ¯ Ù…Ù† ÙƒØªØ§Ø¨Ø© Ø§Ù„Ø£ÙˆØ§Ù…Ø± Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­.';
            }
            
            if (message.includes('Ø£Ù…Ø±') || message.includes('command')) {
                return \`Ù„Ø¥Ø¶Ø§ÙØ© Ø£Ù…Ø± Ø¬Ø¯ÙŠØ¯ØŒ Ø£Ø¶Ù Ù‡Ø°Ø§ Ø§Ù„ÙƒÙˆØ¯:

client.on(Events.MessageCreate, (message) => {
    if (message.content === '!Ø£Ù…Ø±Ùƒ_Ø§Ù„Ø¬Ø¯ÙŠØ¯') {
        message.reply('Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ø§Ù„Ø£Ù…Ø±');
    }
});\`;
            }
            
            if (message.includes('embed') || message.includes('Ø±Ø³Ø§Ù„Ø© Ù…Ø²Ø®Ø±ÙØ©')) {
                return \`Ù„Ø¥Ù†Ø´Ø§Ø¡ Ø±Ø³Ø§Ù„Ø© Ù…Ø²Ø®Ø±ÙØ©:

const { EmbedBuilder } = require('discord.js');

const embed = new EmbedBuilder()
    .setTitle('Ø§Ù„Ø¹Ù†ÙˆØ§Ù†')
    .setDescription('Ø§Ù„ÙˆØµÙ')
    .setColor('#0099ff');

message.reply({ embeds: [embed] });\`;
            }
            
            if (message.includes('Ø¨Ø¯Ø§ÙŠØ©') || message.includes('Ø¬Ø¯ÙŠØ¯') || message.includes('start')) {
                return 'Ø¥Ù„ÙŠÙƒ Ù‚Ø§Ù„Ø¨ Ø£Ø³Ø§Ø³ÙŠ Ù„Ø¨ÙˆØª Ø¯ÙŠØ³ÙƒÙˆØ±Ø¯ Ù…Ø¹ Ø§Ù„Ø£ÙˆØ§Ù…Ø± Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©. ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø¶Ø§ÙØ© ØªÙˆÙƒÙ† Ø§Ù„Ø¨ÙˆØª ÙÙŠ Ø§Ù„Ù†Ù‡Ø§ÙŠØ©!';
            }
            
            // Default responses
            const responses = [
                'ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ ÙÙŠ ØªØ·ÙˆÙŠØ± Ø¨ÙˆØª Ø¯ÙŠØ³ÙƒÙˆØ±Ø¯. Ù…Ø§ Ø§Ù„Ø°ÙŠ ØªØ­ØªØ§Ø¬ Ù…Ø³Ø§Ø¹Ø¯Ø© ÙÙŠÙ‡ØŸ',
                'ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù€ Intents Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø© Ù„Ø¨ÙˆØªÙƒ Ø­Ø³Ø¨ Ø§Ø­ØªÙŠØ§Ø¬Ø§ØªÙƒ.',
                'Ù„Ø§ ØªÙ†Ø³ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø¨ÙˆØª ÙÙŠ Ø³Ø±ÙØ± ØªØ¬Ø±ÙŠØ¨ÙŠ Ù‚Ø¨Ù„ Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡ ÙÙŠ Ø§Ù„Ø³Ø±ÙØ± Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ.',
                'ÙŠÙ…ÙƒÙ†Ùƒ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„Ø£ÙˆØ§Ù…Ø± ÙˆØ§Ù„Ù…ÙŠØ²Ø§Øª Ø­Ø³Ø¨ Ø§Ø­ØªÙŠØ§Ø¬Ø§Øª Ø³Ø±ÙØ±Ùƒ.',
                'ØªØ°ÙƒØ± Ø£Ù† ØªØ­ØªÙØ¸ Ø¨ØªÙˆÙƒÙ† Ø§Ù„Ø¨ÙˆØª Ø¢Ù…Ù†Ø§Ù‹ ÙˆÙ„Ø§ ØªØ´Ø§Ø±ÙƒÙ‡ Ù…Ø¹ Ø£Ø­Ø¯!'
            ];
            
            return responses[Math.floor(Math.random() * responses.length)];
        }

        function generateBotCode() {
            const description = prompt('ØµÙ Ø§Ù„Ø¨ÙˆØª Ø§Ù„Ø°ÙŠ ØªØ±ÙŠØ¯ Ø¥Ù†Ø´Ø§Ø¤Ù‡ (Ù…Ø«Ø§Ù„: Ø¨ÙˆØª ØªØ±Ø­ÙŠØ¨ØŒ Ø¨ÙˆØª Ø¥Ø¯Ø§Ø±Ø©ØŒ Ø¥Ù„Ø®):');
            if (!description) return;
            
            let code = appState.getDefaultCode();
            
            // Generate code based on description
            if (description.includes('ØªØ±Ø­ÙŠØ¨') || description.includes('welcome')) {
                code = \`const { Client, GatewayIntentBits, Events } = require('discord.js');

const client = new Client({
    intents: [
        GatewayIntentBits.Guilds,
        GatewayIntentBits.GuildMembers,
        GatewayIntentBits.GuildMessages,
        GatewayIntentBits.MessageContent,
    ],
});

client.once(Events.ClientReady, () => {
    console.log('Ø¨ÙˆØª Ø§Ù„ØªØ±Ø­ÙŠØ¨ Ø¬Ø§Ù‡Ø²! ğŸ‰');
});

// ØªØ±Ø­ÙŠØ¨ Ø¨Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡ Ø§Ù„Ø¬Ø¯Ø¯
client.on(Events.GuildMemberAdd, (member) => {
    const channel = member.guild.channels.cache.find(ch => ch.name === 'general');
    if (channel) {
        channel.send(\\\`Ù…Ø±Ø­Ø¨Ø§Ù‹ \\\${member.user} ÙÙŠ Ø³Ø±ÙØ±Ù†Ø§! ğŸ‰ Ù†ØªÙ…Ù†Ù‰ Ù„Ùƒ Ø¥Ù‚Ø§Ù…Ø© Ù…Ù…ØªØ¹Ø©.\\\`);
    }
});

client.on(Events.MessageCreate, (message) => {
    if (message.author.bot) return;
    
    if (message.content === '!ØªØ±Ø­ÙŠØ¨') {
        message.reply('Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ! ğŸ‘‹ Ø£Ù‡Ù„Ø§Ù‹ ÙˆØ³Ù‡Ù„Ø§Ù‹ ÙÙŠ Ø³Ø±ÙØ±Ù†Ø§.');
    }
});

client.login('YOUR_BOT_TOKEN_HERE');\`;
            }
            
            if (description.includes('Ù…ÙˆØ³ÙŠÙ‚Ù‰') || description.includes('music')) {
                code = \`const { Client, GatewayIntentBits, Events } = require('discord.js');

const client = new Client({
    intents: [
        GatewayIntentBits.Guilds,
        GatewayIntentBits.GuildMessages,
        GatewayIntentBits.MessageContent,
        GatewayIntentBits.GuildVoiceStates,
    ],
});

client.once(Events.ClientReady, () => {
    console.log('Ø¨ÙˆØª Ø§Ù„Ù…ÙˆØ³ÙŠÙ‚Ù‰ Ø¬Ø§Ù‡Ø²! ğŸµ');
});

client.on(Events.MessageCreate, (message) => {
    if (message.author.bot) return;
    
    if (message.content === '!play') {
        message.reply('ğŸµ ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…ÙˆØ³ÙŠÙ‚Ù‰... (ÙŠØ­ØªØ§Ø¬ Ø¥Ø¹Ø¯Ø§Ø¯ Ø¥Ø¶Ø§ÙÙŠ Ù„Ù„Ù…ÙˆØ³ÙŠÙ‚Ù‰ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ©)');
    }
    
    if (message.content === '!stop') {
        message.reply('â¹ï¸ ØªÙ… Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù…ÙˆØ³ÙŠÙ‚Ù‰.');
    }
    
    if (message.content === '!queue') {
        message.reply('ğŸ“œ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…ÙˆØ³ÙŠÙ‚Ù‰ ÙØ§Ø±ØºØ© Ø­Ø§Ù„ÙŠØ§Ù‹.');
    }
});

client.login('YOUR_BOT_TOKEN_HERE');\`;
            }
            
            const editor = document.getElementById('codeEditor');
            if (editor && window.currentFormData) {
                window.currentFormData.files[appState.selectedFile] = code;
                editor.value = code;
                showNotification('ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ÙƒÙˆØ¯ Ø¨Ù†Ø¬Ø§Ø­! âœ¨', 'success');
            }
        }

        // Initialize App
        const appState = new AppState();
        const router = new Router();

        // Add CSS animations
        const style = document.createElement('style');
        style.textContent = \`
            @keyframes slideIn {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            @keyframes slideOut {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(100%); opacity: 0; }
            }
        \`;
        document.head.appendChild(style);

        // Start the app
        setTimeout(() => {
            document.getElementById('loading').style.display = 'none';
            router.render();
            showNotification('Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ù…Ù†ØµØ© Ø¥Ø¯Ø§Ø±Ø© Ø¨ÙˆØªØ§Øª Ø¯ÙŠØ³ÙƒÙˆØ±Ø¯! ğŸ¤–', 'success');
        }, 500);
    </script>
</body>
</html>